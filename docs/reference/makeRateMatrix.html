<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The RateMatrix class."><title>Rate Matrix — makeRateMatrix • tensoRphylo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Rate Matrix — makeRateMatrix"><meta property="og:description" content="The RateMatrix class."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tensoRphylo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/tensoRphylo.html">Quickstart</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/modelingframework.html">Models</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/dataformat.html">Input</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/api.html">API</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Rate Matrix</h1>
      
      <div class="d-none name"><code>makeRateMatrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>RateMatrix</code> class.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">makeRateMatrix</span><span class="op">(</span>num_states <span class="op">=</span> <span class="cn">NULL</span>, rate <span class="op">=</span> <span class="fl">0</span>, matrix <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This class is for instantaneous rate matrices, which describe the rate of change from state <em>i</em> (rows) to state <em>j</em> (columns).
In tensorphylo, these matrices are used to describe "anagenetic", "asynchronous" events, i.e., changes in state that are not associated with speciation events, and occur independently among lineages.
This is directly analogous to the Q matrix of a substitution model.</p>
<p>Objects of the class <code>RateMatrix</code> have off-diagonal elements that are strictly positive and diagonal elements such that the sum of each row is zero.
Attempting to set the value of a diagonal element is prohibited, as they are computed automatically from the off-diagonal elements.
Likewise, the class enforces that off-diagonal elements must &gt;= 0.</p>
<p>For models with time-dependent rate matrices, use the generic <code>c</code> to create a vector of rate matrices (of class <code>RateMatrixList</code>):</p><div class="sourceCode"><pre><code><span class="va">Q_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeRateMatrix.html">makeRateMatrix</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">Q_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeRateMatrix.html">makeRateMatrix</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.2</span><span class="op">)</span>
<span class="va">Qs</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Q_1</span>, <span class="va">Q_2</span><span class="op">)</span></code></pre></div>
<div class="section">
<h3 id="constructors">Constructors<a class="anchor" aria-label="anchor" href="#constructors"></a></h3>


<p>Create a new object of class <code>RateMatrix</code>.</p><ul><li><p><code>makeRateMatrix(num_states)</code> where <code>num_states</code> is an integer. Creates a <code>num_states</code> x <code>num_states</code> rate matrix with rate zero.</p></li>
<li><p><code>makeRateMatrix(num_states, rate)</code> where <code>num_states</code> is an integer and <code>rate</code> is a numeric. Creates a <code>num_states</code> x <code>num_states</code> rate matrix with average rate <code>rate</code>.</p></li>
<li><p><code>makeRateMatrix(matrix = Q)</code> where <code>Q</code> is a <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">base::matrix</a></code>. Creates a rate matrix with the same values as in <code>Q</code>.</p></li>
</ul></div>

<div class="section">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h3>


<p>Call a method on a <code>RateMatrix</code> object <code>Q</code> with <code>Q$methodName(arguments)</code>.</p><ul><li><p><code>getMatrix()</code>: Returns a standard R <a href="https://rdrr.io/r/base/matrix.html" class="external-link">base::matrix</a>.</p></li>
</ul></div>

<div class="section">
<h3 id="accessors">Accessors<a class="anchor" aria-label="anchor" href="#accessors"></a></h3>


<p><code>RateMatrix</code> provides intuitive access to elements of the rate matrix, but enforces some behavior.</p><ul><li><p><code>[i,j]</code> returns value in the _i_th row and _j_th column.</p></li>
<li><p><code>[i,j] &lt;- y</code> sets the value of the _ij_th element to y. <strong><em>Will result in an error if you attempt to set a diagonal value, or attempt to set an off-diagonal element to a negative value.</em></strong></p></li>
</ul></div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># create a 4x4 rate matrix with average rate of 0.1 (ie a Jukes-Cantor model with mu = 0.1).</span></span>
<span class="r-in"><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu">makeRateMatrix</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># set the rate from 1 to 2 to 0.2</span></span>
<span class="r-in"><span class="va">Q</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># setting a diagonal value is prohibited</span></span>
<span class="r-in"><span class="va">Q</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># likewise, setting an off-diagonal value to a negative number is prohibited</span></span>
<span class="r-in"><span class="va">Q</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.1</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># construct a time-homogeneous rate matrix model</span></span>
<span class="r-in"><span class="va">Q</span>  <span class="op">&lt;-</span> <span class="fu">makeRateMatrix</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">TensorPhyloInstance</span>, <span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tp</span><span class="op">$</span><span class="fu">setEtaConstantUnequal</span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># construct a time-heterogeneous rate matrix model</span></span>
<span class="r-in"><span class="va">Q_1</span> <span class="op">&lt;-</span> <span class="fu">makeRateMatrix</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Q_2</span> <span class="op">&lt;-</span> <span class="fu">makeRateMatrix</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Qs</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Q_1</span>, <span class="va">Q_2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">t</span>   <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span class="r-in"><span class="va">tp</span>  <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="va">TensorPhyloInstance</span>, <span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tp</span><span class="op">$</span><span class="fu">setEtaTimeDependentUnequal</span><span class="op">(</span><span class="va">t</span>, <span class="va">Qs</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael R. May.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

